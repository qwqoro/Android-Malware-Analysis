# –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –î–ò–ù–ê–ú–ò–ß–ï–°–ö–ò–ô –ê–ù–ê–õ–ò–ó

- [**4.0**](#40-–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞):‚ÄÇ‚Äü–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞‚Äù
- [**4.1**](#41-–∞–Ω–∞–ª–∏–∑-—Å–∏—Å—Ç–µ–º–Ω—ã—Ö-–º–µ—Ç—Ä–∏–∫):‚ÄÇ‚Äü–ê–Ω–∞–ª–∏–∑ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫‚Äù
- [**4.2**](#42-–∞–Ω–∞–ª–∏–∑-–∏–∑–º–µ–Ω–µ–Ω–∏–π-–≤-—Ñ–∞–π–ª–æ–≤–æ–π-—Å–∏—Å—Ç–µ–º–µ):‚ÄÇ‚Äü–ê–Ω–∞–ª–∏–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ‚Äù
- [**4.3**](#43-–∞–Ω–∞–ª–∏–∑-—Å–µ—Ç–µ–≤–æ–≥–æ-—Ç—Ä–∞—Ñ–∏–∫–∞):‚ÄÇ‚Äü–ê–Ω–∞–ª–∏–∑ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞‚Äù
- [**4.4**](#44-–∞–Ω–∞–ª–∏–∑-–≤—ã–∑–æ–≤–æ–≤-api--–∞–Ω–∞–ª–∏–∑-—Å–∏—Å—Ç–µ–º–Ω—ã—Ö-–≤—ã–∑–æ–≤–æ–≤):‚ÄÇ‚Äü–ê–Ω–∞–ª–∏–∑ –≤—ã–∑–æ–≤–æ–≤ API + –ê–Ω–∞–ª–∏–∑ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤‚Äù
- [**4.5**](#45-–ø—Ä–æ—á–∏–µ-–ª—é–±–æ–ø—ã—Ç–Ω—ã–µ-–≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è):‚ÄÇ‚Äü–ü—Ä–æ—á–∏–µ –ª—é–±–æ–ø—ã—Ç–Ω—ã–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è‚Äù

<br>

![gif](../images/gif_04.gif)

<p align="center">
	<b>
		<a href="#%EF%B8%8F-–∑–∞–º–µ—Ç–∫–∏">–ó–∞–º–µ—Ç–∫–∏</a> |
		<a href="#-–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ</a>
	</b>
</p>

## ‚úèÔ∏è –ó–∞–º–µ—Ç–∫–∏

### 4.0 –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

#### üß∞ \[ –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ä–∏–π \]
| –£—Ç–∏–ª–∏—Ç–∞ / –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –ü—Ä–∏–º–µ—Ä –≤—ã–∑–æ–≤–∞ | –î–µ–π—Å—Ç–≤–∏–µ |
| :-- | :-- | :-- |
| **Wireshark** \[[üîó](https://github.com/wireshark/wireshark)\] | - | GUI; –õ–æ–≥–∏—Ä—É–µ—Ç —Å–µ—Ç–µ–≤–æ–π —Ç—Ä–∞—Ñ–∏–∫ |
| **tcpdump** \[[üîó](https://github.com/the-tcpdump-group/tcpdump)\] | `tcpdump -A tcp port <–ø–æ—Ä—Ç>` | CLI; –õ–æ–≥–∏—Ä—É–µ—Ç —Å–µ—Ç–µ–≤–æ–π —Ç—Ä–∞—Ñ–∏–∫ |
| **Frida** \[[üîó](https://github.com/frida/frida)\] | `frida -l disableRoot.js -f owasp.mstg.uncrackable1` | –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, –ø–æ–∑–≤–æ–ª—è–µ—Ç: –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—ã–∑–æ–≤—ã, —Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –ø–∞–º—è—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –ø–æ–¥—Å—Ç—Ä–æ–∫, –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –≤—ã–∑–æ–≤—ã –Ω–∞—Ç–∏–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π, ... |
| **Medusa** \[[üîó](https://github.com/Ch0pin/medusa)\] | `medusa> use <–∏–º—è-—Å–∫—Ä–∏–ø—Ç–∞>` | –ö–æ–ª–ª–µ–∫—Ü–∏—è —Å–∫—Ä–∏–ø—Ç–æ–≤ –¥–ª—è Frida; –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –∏–Ω—ä–µ–∫—Ü–∏–∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å—ã |
| **objection** \[[üîó](https://github.com/sensepost/objection)\] | `objection --gadget <–ø–∞–∫–µ—Ç> explore` | –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –≤–æ –≤—Ä–µ–º—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è: –∏–∑—É—á–µ–Ω–∏–µ –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π, –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–∞–º–ø–∞ –∏ –ø–∞—Ç—á–∞ –ø–∞–º—è—Ç–∏, –º–∞–Ω–∏–ø—É–ª—è—Ü–∏—è –æ–±—ä–µ–∫—Ç–∞–º–∏ –≤ –∫—É—á–µ, ... |
| **House** \[[üîó](https://github.com/nccgroup/house)\] | `python app.py <–ø–æ—Ä—Ç>` | –ò–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä—É–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Ö—É–∫ —Ñ—É–Ω–∫—Ü–∏–π –∏ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –Ω–∞–ø–∏—Å–∞–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–æ–≤ Frida –∏ –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è |
| **Xposed** \[[üîó](https://github.com/ElderDrivers/EdXposed)\]<br>**LSPosed** \[[üîó](https://github.com/LSPosed/LSPosed)\] |  | –ü–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π / –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–æ—à–∏–≤–æ–∫ –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–µ–∫–æ–º–ø–∏–ª—è—Ü–∏–∏, –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –∏ –ø–µ—Ä–µ–ø–æ–¥–ø–∏—Å—ã–≤–∞–Ω–∏—è |
| **WebViewDebugHook** \[[üîó](https://github.com/feix760/WebViewDebugHook)\] |  | –ú–æ–¥—É–ª—å –¥–ª—è Xposed; –ü–æ–∑–≤–æ–ª—è–µ—Ç –¥–µ—Ç–∞–ª—å–Ω–æ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å WebView –≤ –±—Ä–∞—É–∑–µ—Ä–µ |
| **XIntent** \[[üîó](https://github.com/2Y2s1mple/xintent)\] |  | –ú–æ–¥—É–ª—å –¥–ª—è Xposed; –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç —Ç—Ä–∞—Ñ–∏–∫, –ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã–π –Ω–∞–º–µ—Ä–µ–Ω–∏—è–º–∏ |
<br>

#### ü™§ \[ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ \]

> [üîó –£—Ä–æ–∫–∏ –ø–æ Frida –æ—Ç HackTricks](https://book.hacktricks.xyz/mobile-pentesting/android-app-pentesting/frida-tutorial)

1. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ Frida:
```bash
unxz frida-server.xz
adb root
adb push frida-server /data/local/tmp/
adb shell "chmod 755 /data/local/tmp/frida-server"
adb shell "su -—Å /data/local/tmp/frida-server &"
```
2. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Frida –∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É:
```bash
# -U                                                      # –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É –ø–æ USB
# -D emulator-<ID>                                        # –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —ç–º—É–ª—è—Ç–æ—Ä—É
frida <-D emulator-<ID> –∏–ª–∏ -U> <–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä-–ø—Ä–æ—Ü–µ—Å—Å–∞>  # –∏–Ω—ä–µ–∫—Ü–∏—è Frida –≤ –ø—Ä–æ—Ü–µ—Å—Å
frida <-D emulator-<ID> –∏–ª–∏ -U> -f <–ø–∞–∫–µ—Ç>                # Frida –∑–∞–ø—É—Å—Ç–∏—Ç –ø–∞–∫–µ—Ç
```
3. –í—ã–≤–æ–¥ —Å–ø–∏—Å–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤:
```bash
frida-ps -U
```
4. –ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤:
```bash
frida -U -f <–ø–∞–∫–µ—Ç> -l <—Å–∫—Ä–∏–ø—Ç>
```
<br>

### 4.1 –ê–Ω–∞–ª–∏–∑ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫
> [üîó –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç dumpsys](https://developer.android.com/tools/dumpsys)

| –î–µ–π—Å—Ç–≤–∏–µ | –ö–æ–º–∞–Ω–¥–∞ | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
| :-- | :-- | --: |
| üë§&ensp;–ü–æ–ª—É—á–∏—Ç—å UID –ø–∞–∫–µ—Ç–∞ | `adb shell dumpsys package <–ø–∞–∫–µ—Ç> \| grep userId` | –ú–æ–∂–µ—Ç –ø–æ–Ω–∞–¥–æ–±–∏—Ç—å—Å—è –¥–ª—è –≤—ã–∑–æ–≤–∞ –∫–æ–º–∞–Ω–¥ / –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–∞–∫–µ—Ç–∞ —Å—Ä–µ–¥–∏ –≤—ã–≤–æ–¥–∞ |
| üì§&ensp;–ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Å–µ—Ç–∏ | `adb shell dumpsys netstats detail` |  |
| üîã&ensp;–ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –±–∞—Ç–∞—Ä–µ–∏ | `adb shell dumpsys batterystats --charged <–ø–∞–∫–µ—Ç>` | –° –º–æ–º–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∑–∞—Ä—è–¥–∫–∏ |
| üß†&ensp;–ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –ø–∞–º—è—Ç–∏ | `adb shell dumpsys procstats --hours <–≤—Ä–µ–º—è>` | –í —Ç–µ—á–µ–Ω–∏–∏ –∫–∞–∫–æ–≥–æ-—Ç–æ –≤—Ä–µ–º–µ–Ω–∏ |
| üß†&ensp;–ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –ø–∞–º—è—Ç–∏ | `adb shell dumpsys meminfo <–ø–∞–∫–µ—Ç> -d` | –í –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –º–æ–º–µ–Ω—Ç |
| ‚öôÔ∏è&ensp;–ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é CPU | `adb shell dumpsys cpuinfo <–ø–∞–∫–µ—Ç>` |  |
<br>

### 4.2 –ê–Ω–∞–ª–∏–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ

- –°—Ä–∞–≤–Ω–∏—Ç—å –≤—ã–≤–æ–¥ –∫–æ–º–∞–Ω–¥—ã ‚Äì —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –î–û / –ü–û–°–õ–ï –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏–π:
> //&ensp;–í –ø—Ä–∏–º–µ—Ä–µ —É–∫–∞–∑–∞–Ω –ø—É—Ç—å –∫ —Ñ–∞–π–ª–∞–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è `/data/data/<–ø–∞–∫–µ—Ç>`;
> <br>//&ensp;–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ –¥—Ä—É–≥–∏–µ –ø—É—Ç–∏, –≤ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏ ‚Äì –æ–±—â–µ–µ –≤–Ω–µ—à–Ω–µ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ;
```bash
adb shell "find /data/data/<–ø–∞–∫–µ—Ç/–ø—É—Ç—å> -type f -exec file {} \;"
```

- –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:
```bash
adb shell "find /data/data/<–ø–∞–∫–µ—Ç>/databases -name '*.db'"   # –í—ã–≤–µ—Å—Ç–∏ .db —Ñ–∞–π–ª—ã
sqlite3 <–∏–º—è-—Ñ–∞–π–ª–∞>.db                                       # –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
.tables                                                      # –í—ã–≤–µ—Å—Ç–∏ —Ç–∞–±–ª–∏—Ü—ã
.schema <–∏–º—è-—Ç–∞–±–ª–∏—Ü—ã>                                        # –í—ã–≤–µ—Å—Ç–∏ —Å—Ö–µ–º—É —Ç–∞–±–ª–∏—Ü—ã
```

- –í—ã–∫–∞—á–∞—Ç—å –ª—é–±–æ–ø—ã—Ç–Ω—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞:
```bash
adb pull <–º–µ—Å—Ç–Ω—ã–π-–ø—É—Ç—å> <–ø—É—Ç—å-–∫—É–¥–∞-–∑–∞–ø–∏—Å–∞—Ç—å>
```
<br>

### 4.3 –ê–Ω–∞–ª–∏–∑ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞
1. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–∞—Ñ–∏–∫–∞ —Å –ø–æ–º–æ—â—å—é `tcpdump` + —Å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –∑–∞–ø–∏—Å—å—é –≤ `Wireshark` –¥–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç–∏:
```bash
adb exec-out "/data/local/tmp/tcpdump -i any -U -w - 2>/dev/null" | wireshark -k -S -i -
```

2. –ü–µ—Ä–µ—Ö–≤–∞—Ç –≤–µ–±-—Ç—Ä–∞—Ñ–∏–∫–∞ –≤ Burp Suite –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞;
> [üîó –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ Burp Suite –æ—Ç PortSwigger](https://portswigger.net/burp/documentation/desktop/mobile/config-android-device)
> <br>[üîó –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ Burp Suite –æ—Ç HackTricks](https://book.hacktricks.xyz/mobile-pentesting/android-app-pentesting/install-burp-certificate)
<br>

### 4.4 –ê–Ω–∞–ª–∏–∑ –≤—ã–∑–æ–≤–æ–≤ API + –ê–Ω–∞–ª–∏–∑ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ —á–µ—Ä–µ–∑ `logcat`:
```bash
adb shell ps | grep <–ø–∞–∫–µ—Ç>                 # –ü–æ–ª—É—á–∏—Ç—å –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞
adb logcat --pid=<–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä-–ø—Ä–æ—Ü–µ—Å—Å–∞>   # –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```

- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ —á–µ—Ä–µ–∑ `pidcat` \[[üîó](https://github.com/JakeWharton/pidcat)\]:
```bash
pidcat <–ø–∞–∫–µ—Ç>
```

- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ —á–µ—Ä–µ–∑ `strace`:
```bash
adb shell strace -f -p <–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä-–ø—Ä–æ—Ü–µ—Å—Å–∞>
```

- –¢—Ä–µ–π—Å —Ñ—É–Ω–∫—Ü–∏–π –Ω–∞—Ç–∏–≤–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ —Å –ø–æ–º–æ—â—å—é `frida-trace`:
```bash
frida-trace -U <–ø–∞–∫–µ—Ç> -i "<—Ñ—É–Ω–∫—Ü–∏—è>"
```

- –ü—Ä–∏–º–µ—Ä –ø–æ–∏—Å–∫–∞ –ª—é–±–æ–ø—ã—Ç–Ω—ã—Ö API —Å –ø–æ–º–æ—â—å—é `frida-trace`:
```bash
frida-trace -U -j 'javax.crypto.Cipher!*' \
               -j 'javax.crypto.spec.SecretKeySpec!*' \
               -f <–ø–∞–∫–µ—Ç>
```

- –ò—Å–ø–æ–ª—å–∑—É—è [`objection`](#-objection):

| –î–µ–π—Å—Ç–≤–∏–µ | –ö–æ–º–∞–Ω–¥–∞ |
| :-- | :-- |
| –í—ã–≤–µ—Å—Ç–∏ –≤—Å–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –∫–ª–∞—Å—Å—ã | `android hooking list classes` |
| –ü–æ–∏—Å–∫ –∫–ª–∞—Å—Å–æ–≤, –∏–º—è –∫–æ—Ç–æ—Ä—ã—Ö –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å <–ø–æ–¥—Å—Ç—Ä–æ–∫–∞> | `android hooking search classes <–ø–æ–¥—Å—Ç—Ä–æ–∫–∞>` |
| –í—ã–≤–µ—Å—Ç–∏ –º–µ—Ç–æ–¥—ã –∫–ª–∞—Å—Å–∞ | `android hooking search methods <–ø–∞–∫–µ—Ç> <–∏–º—è-–∫–ª–∞—Å—Å–∞>` |
| –í—ã–≤–µ—Å—Ç–∏ –æ–±—ä—è–≤–ª–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∫–ª–∞—Å—Å–∞ –≤–º–µ—Å—Ç–µ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ | `android hooking list class_methods <–ø–∞–∫–µ—Ç>.<–∏–º—è-–∫–ª–∞—Å—Å–∞>` |
| –•—É–∫ –Ω–∞ –º–µ—Ç–æ–¥<br>–í—ã–≤–æ–¥ —Å–≤—è–∑–∞–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –≤—ã–∑–æ–≤–µ –º–µ—Ç–æ–¥–∞ | `android hooking watch class_method <–ø–∞–∫–µ—Ç>.<–∏–º—è-–∫–ª–∞—Å—Å–∞>.<–º–µ—Ç–æ–¥> --dump-args --dump-backtrace --dump-return` |
| –•—É–∫ –Ω–∞ –∫–ª–∞—Å—Å<br>–í—ã–≤–æ–¥ —Å–≤—è–∑–∞–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –≤—ã–∑–æ–≤–µ –º–µ—Ç–æ–¥–æ–≤ –∫–ª–∞—Å—Å–∞ | `android hooking watch class <–ø–∞–∫–µ—Ç>.<–∏–º—è-–∫–ª–∞—Å—Å–∞> --dump-args --dump-return` |
| –í—ã–≤–æ–¥ –∂–∏–≤—ã—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ Java –∫–ª–∞—Å—Å–∞ | `android heap print_instances <–∏–º—è-–∫–ª–∞—Å—Å–∞>` |
<br>

### 4.5 –ü—Ä–æ—á–∏–µ –ª—é–±–æ–ø—ã—Ç–Ω—ã–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Keystore —Å –ø–æ–º–æ—â—å—é `tracer-cipher.js` \[[üîó](https://github.com/WithSecureLabs/android-keystore-audit/blob/master/frida-scripts/tracer-cipher.js)\]:
```bash
frida -U -f <–ø–∞–∫–µ—Ç> -l frida-scripts/tracer-cipher.js
```

- –î–∞–º–ø –ø–∞–º—è—Ç–∏ —Å –ø–æ–º–æ—â—å—é `fridump` \[[üîó](https://github.com/Nightbringer21/fridump)\]:
```bash
python fridump.py -U <–ø–∞–∫–µ—Ç> -o <–ø—É—Ç—å-–∫—É–¥–∞-–∑–∞–ø–∏—Å–∞—Ç—å>
```

- –≠–º—É–ª—è—Ü–∏—è SMS:
```bash
adb emu sms send <–Ω–æ–º–µ—Ä-—Ç–µ–ª–µ—Ñ–æ–Ω–∞> <—Ç–µ–∫—Å—Ç>
```
<br>

#### üß∑ ADB Activity Manager
> [üîó –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ Activity Manager](https://developer.android.com/tools/adb#am)

| –î–µ–π—Å—Ç–≤–∏–µ | –ö–æ–º–∞–Ω–¥–∞ |
| :-- | :-- |
| –ó–∞–ø—É—Å–∫ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏, –æ–ø—Ä–µ–¥–µ–ª—è–µ–º–æ–π –Ω–∞–º–µ—Ä–µ–Ω–∏–µ–º | `adb shell am start <–æ–ø—Ü–∏–∏> <–Ω–∞–º–µ—Ä–µ–Ω–∏–µ>` |
| –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞, –æ–ø—Ä–µ–¥–µ–ª—è–µ–º–æ–≥–æ –Ω–∞–º–µ—Ä–µ–Ω–∏–µ–º | `adb shell am startservice <–æ–ø—Ü–∏–∏> <–Ω–∞–º–µ—Ä–µ–Ω–∏–µ>` |
| –¢—Ä–∞–Ω—Å–ª—è—Ü–∏—è –Ω–∞–º–µ—Ä–µ–Ω–∏—è | `adb shell am broadcast <–æ–ø—Ü–∏–∏> <–Ω–∞–º–µ—Ä–µ–Ω–∏–µ>` |
| –î–∞–º–ø –∫—É—á–∏ –≤ —Ñ–∞–π–ª | `adb shell am dumpheap <–æ–ø—Ü–∏–∏> <–ø—Ä–æ—Ü–µ—Å—Å> <–ø—É—Ç—å-–∫—É–¥–∞-–∑–∞–ø–∏—Å–∞—Ç—å>` |
<br>

#### üîß Objection
> [üîó –£—Ä–æ–∫ –ø–æ Objection –æ—Ç HackTricks](https://book.hacktricks.xyz/mobile-pentesting/android-app-pentesting/frida-tutorial/objection-tutorial)

- –í–æ–π—Ç–∏ –≤ —Ä–µ–∂–∏–º –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è —Å –ø–æ–º–æ—â—å—é `objection`:
```bash
objection -g <–ø–∞–∫–µ—Ç> explore
```

- –ü—Ä–∏–º–µ—Ä –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å—Ä–µ–¥—ã (_–ø–∞—Ä–æ–ª–∏, –ø—É—Ç–∏, ..._) —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã `env`:
```bash
[usb] # env

Name                     Path
-----------------------  -------------------------------
cacheDirectory           /data/user/0/–ø–∞–∫–µ—Ç/cache
codeCacheDirectory       /data/user/0/–ø–∞–∫–µ—Ç/code_cache
externalCacheDirectory   /storage/emulated/0/Android/data/–ø–∞–∫–µ—Ç/cache
filesDirectory           /data/user/0/–ø–∞–∫–µ—Ç/files
```

| –î–µ–π—Å—Ç–≤–∏–µ | –ö–æ–º–∞–Ω–¥–∞ |
| :-- | :-- |
| –ü–æ–ø—ã—Ç–∫–∞ –æ—Ç–∫–ª—é—á–∏—Ç—å –¥–µ—Ç–µ–∫—Ç —Ä—É—Ç–∞ | `android root disable` |
| –ü–æ–ø—ã—Ç–∫–∞ —Å–∏–º—É–ª—è—Ü–∏–∏ —Ä—É—Ç–∞ | `android root simulate` |
| –í—ã–≤–µ—Å—Ç–∏ —Ç–µ–∫—É—â—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å | `android hooking get current_activity` |
| –í—ã–≤–µ—Å—Ç–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–∞–∫–µ—Ç–∞ | `android hooking list activities` |
| –í—ã–≤–µ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å—ã –ø–∞–∫–µ—Ç–∞ | `android hooking list services` |
| –í—ã–≤–µ—Å—Ç–∏ –ø—Ä–∏—ë–º–Ω–∏–∫–∏ –ø–∞–∫–µ—Ç–∞ | `android hooking list receivers` |
| –î–∞–º–ø –≤—Å–µ–π –ø–∞–º—è—Ç–∏ –≤ —Ñ–∞–π–ª | `memory dump all <–ø—É—Ç—å-–∫—É–¥–∞-–∑–∞–ø–∏—Å–∞—Ç—å>` |
| –î–∞–º–ø –æ–±–ª–∞—Å—Ç–∏ –ø–∞–º—è—Ç–∏ –≤ —Ñ–∞–π–ª | `memory dump from_base <–±–∞–∑–æ–≤—ã–π-–∞–¥—Ä–µ—Å> <—Ä–∞–∑–º–µ—Ä-–¥–∞–º–ø–∞> <–ø—É—Ç—å-–∫—É–¥–∞-–∑–∞–ø–∏—Å–∞—Ç—å>` |
<br>

## üìë –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ
- \[ üìô \]&emsp;**–ú–∞–Ω—É–∞–ª**: —Å–ø–∏—Å–æ–∫ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–±–∏–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –æ—Ç OWASP [üîó](https://mas.owasp.org/MASTG/tools/)
- \[ üìó \]&emsp;**–ì–∞–π–¥**: ‚ÄüFrida Tutorial‚Äù –æ—Ç HackTricks [üîó](https://book.hacktricks.xyz/mobile-pentesting/android-app-pentesting/frida-tutorial)
- \[ üìó \]&emsp;**–ì–∞–π–¥**: ‚ÄüObjection Tutorial‚Äù –æ—Ç HackTricks [üîó](https://book.hacktricks.xyz/mobile-pentesting/android-app-pentesting/frida-tutorial/objection-tutorial)
- \[ :octocat: \]&ensp;**–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**: ‚ÄüMobile Security Framework‚Äù –æ—Ç OWASP [üîó](https://github.com/MobSF/Mobile-Security-Framework-MobSF)
- \[ :octocat: \]&ensp;**–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**: ‚ÄüAndroid Application Analyzer‚Äù –æ—Ç NotSoSecure [üîó](https://github.com/NotSoSecure/android_application_analyzer)
